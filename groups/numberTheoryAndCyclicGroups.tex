\documentclass{ximera}

\input{../preamble.tex}

\title{Number theory and cyclic groups}

\begin{document}
\begin{abstract}
  We further explore cyclic groups.
\end{abstract}
\maketitle


\begin{definition} \index{greatest common divisor}\index{GCD}
An integer $g$ is called a \textbf{greatest common divisor} of two
integers $m$ and $n$ provided that
\begin{enumerate}
\item $g| m$ and $g | n$.
\item If $d$ is an element where $d| m$ and $d | n$, then $d\le g$.
\end{enumerate}
We denote the GCD of $m$ and $n$ as $\gcd(m,n)$. If $\gcd(m,n) = 1$ we
say that $m$ and $n$ are \dfn{coprime} or \dfn{relatively prime}.
\end{definition}


\begin{exercise} 
Given $n\in \Z$, what is $\gcd(n,0)$? Prove your conclusion.
\end{exercise}

\begin{exercise} 
Prove that if $a$ is any integer, then $\gcd(m + a\cdot n, n) =
\gcd(m, n)$.
\end{exercise}




\begin{theorem}[Euclid's lemma, version 1]\label{T:EL1}\index{Euclid's lemma}
  Given nonzero $m,n\in\Z$, $g=\gcd(m,n)$ is the \textit{smallest}
  positive integer such that
  \[
  g = a\cdot m +b\cdot n
  \]
  for some integers $a$ and $b$.
  \begin{sketch} We will prove this in several steps.
  \begin{enumerate}
  \item Let $\mathcal S = \{x\in \N: x = a\cdot m +b\cdot n\text{ for } a,b\in
    \Z\}$. Prove that $\mathcal S$ has a least element, call it $d$.
  \item Prove that $d| x$ for all $x\in \mathcal S$.
  \item Prove that $d| m$ and $d| n$. Explain why $1 \le d \le g$.
  \item Recall that $d = a\cdot m +b\cdot n$, and prove that $g |
    d$. Explain why we must conclude that $d = g$.
  \end{enumerate}
  \end{sketch}
\end{theorem}



\begin{corollary}[Euclid's lemma, version 2]\label{C:EL2}\index{Euclid's lemma}
  Let $\l$, $m$, and $n$ be nonzero integers. If 
  \[
  \l|mn\qquad\text{and}\qquad \gcd(\l,m)=1,
  \]
  then $\l|n$. 
\end{corollary}


The statements of Theorem~\ref{T:EL1} and Corollary~\ref{C:EL2} are
each sometimes referred to as \dfn{Euclid's lemma}. This fact appears as \link[Proposition 30 in Book VII]{https://mathcs.clarku.edu/~djoyce/java/elements/bookVII/propVII30.html} of
\textit{Euclid's elements}.



\begin{corollary}[Generators of cyclic groups]
  An element $g\in \Z_n$ generates $\Z_n$ if and only if $\gcd(g,n) =
  1$.
  \begin{sketch}
    $(\Rightarrow)$ If $g\in\Z_n$ generates $\Z_n$, then there is
    $a\in\N$ such that
    \[
    ag \equiv 1\pmod{n}.
    \]
    Work from here to show that $\gcd(g,n) = 1$.
    

    $(\Leftarrow)$ If $\gcd(g,n) = 1$, use Euclid's lemma,
    Theorem~\ref{T:EL1}.
  \end{sketch}
\end{corollary}

\begin{exercise}
  Find all the generators of $\Z_{12}$. Explain why your solution is correct.
\end{exercise}


\begin{exercise}
  Find all the generators of $\Z_{24}$. Explain why your solution is correct.
\end{exercise}





\begin{corollary}[A characterization of prime numbers]\label{E:EL}\index{prime number}
  A natural number $p\in \N$ has exactly two factors, $1$ and $p$ if
  and only if for all $m,n\in\N$
  \[
  p|mn \quad \Rightarrow \quad p|m \text{ or } p|n.
  \]
  \begin{sketch}
    The proof is basically three steps:
    \begin{enumerate}
    \item Suppose that $p\nmid m$, explain why $\gcd(m,p) =1$.
    \item Write $1 = am + bp$, multiply both sides by $n$.
    \item Can you finish it from here?
    \end{enumerate}
  \end{sketch}
\end{corollary}






\begin{exercise} Prove that if $\gcd(m,n) = 1$, then 
\[
in \equiv jn \pmod m \qquad \Rightarrow\qquad i\equiv j\pmod m.
\]
\end{exercise}



\begin{exercise} Study the following calculations:
\begin{align*}
  22 &= \boldsymbol{6}\cdot 3 + \boldsymbol{4}\\
  \boldsymbol{6} &= \boldsymbol{4} \cdot 1 + \fbox{$\boldsymbol{2}$}\\
  \boldsymbol{4} &= \boldsymbol{2} \cdot 2 + 0 \qquad
\therefore \gcd(22,6) = 2
\end{align*}

\begin{align*}
33 &= \boldsymbol{24}\cdot 1 + \boldsymbol{9}\\
\boldsymbol{24} &= \boldsymbol{9} \cdot 2 + \boldsymbol{6}\\
\boldsymbol{9} &= \boldsymbol{6} \cdot 1 + \fbox{$\boldsymbol{3}$}\\
\boldsymbol{6} &= \boldsymbol{3} \cdot 2 + 0 \qquad \therefore \gcd(33,24) = 3 
\end{align*}

\begin{align*}
42 &= \boldsymbol{16}\cdot 2 + \boldsymbol{10}\\
\boldsymbol{16} &= \boldsymbol{10} \cdot 1 + \boldsymbol{6}\\
\boldsymbol{10} &= \boldsymbol{6} \cdot 1 + \boldsymbol{4}\\
\boldsymbol{6} &= \boldsymbol{4} \cdot 1 + \fbox{$\boldsymbol{2}$}\\
\boldsymbol{4} &= \boldsymbol{2} \cdot 2 + 0 \qquad \therefore \gcd(42,16) = 2 
\end{align*}

Explain how the above algorithm works and write it under the Euclidean
algorithm below.
\end{exercise}


\begin{theorem}[Euclidean algorithm] 
We can easily compute the GCD of two numbers $m,n\in\Z$ using the
following algorithm:
\vspace{2in}

\end{theorem}
\noindent The above space has intentionally been left blank for you to
fill in.

\begin{exercise} 
We will prove that when working with integers, the Euclidean algorithm
will always produce the GCD of two numbers.
\begin{enumerate}
\item Prove that the remainders found in the Euclidean algorithm form a
  decreasing sequence.
\item Prove that this sequence must terminate with a final remainder
  of zero.
\item Proceed by induction on the number of steps in the Euclidean
  Algorithm. If there are two steps:
\begin{align*}
m &= n\cdot q_1 + g \\
n &= g\cdot q_2 +0
\end{align*}
Prove that any divisor of both $a$ and $b$ is necessarily a divisor
of $g$. Explain why this proves that $g = \gcd(m,n)$.
\item Now suppose that any time we have $i+1$ equations:
\begin{align*}
a &= b\cdot q_1 + r_1 \\
b &= r_1\cdot q_2 + r_2 \\
  &\hspace{.5em}\vdots\\
r_{i-2} &= r_{i-1}\cdot q_{i} + r_i\\
r_{i-1} &= r_{i}\cdot q_{i+1} + 0
\end{align*}
that $r_i = \gcd(m,n)$. Prove that when we have $i+2$ equations, $r_{i+1}
= \gcd(m,n)$.
\item Explain how we have proved that when working with integers, the
  Euclidean algorithm will always produce the GCD of two numbers.
\end{enumerate}
\end{exercise}


\begin{exercise} 
Prove that if $x = am +bn$ and $d$ is a common divisor of $m$ and $n$,
then $d|x$. Explain how this shows that every common divisor of $m$
and $n$ also divides $\gcd(m,n)$.
\end{exercise}







\section{Direct products of cyclic groups}


\begin{lemma}[Order of direct product groups]
  Let $G$ and $H$ be finite groups. In this case,
  \[
  |G\times H| = |G|\cdot |H|.
  \]
  \begin{sketch}
    Recall that
    \[
    G\times H := \{(g,h): \text{$g\in G$ and $h\in H$}\}.
    \]
  \end{sketch}
\end{lemma}

\begin{exercise}
  What is the order of $\Z_6\times\Z_7$. Is this the
  ``\link[ultimate question]{https://en.wikipedia.org/wiki/42\_(number)}?''
\end{exercise}



\begin{theorem}[Criterion for cyclic direct product]
  The group $\Z_p\times \Z_q$ is cyclic if and only if $\gcd(p,q) =
  1$.
  \begin{proof}
    $(\Rightarrow)$ We will prove this direction by way of
    contraposition. Suppose that $\gcd(p,q) = g>1$. We must show that
    $\Z_p\times \Z_q$ is not cyclic. Consider $(a,b)\in\Z_p\times\Z_q$
    and note that $\frac{p}{g}\in\N$ and $\frac{q}{g}\in\N$. Write
    with me:
    \begin{align*}
      (a,b) \cdot \frac{pq}{g} &= \left(ap\left(\frac{q}{g}\right),bq\left(\frac{p}{g}\right)\right)\\
      &\equiv (0,0).
    \end{align*}
    Hence $\o((a,b)) \le \frac{pq}{g} < |\Z_p\times\Z_q|$, and so
    $\Z_p\times\Z_q$ cannot be cyclic.

    $(\Leftarrow)$ Suppose that $\gcd(p,q) = 1$ and that
    \[
    (1,1)\cdot n = (n,n) \equiv (0,0).
    \]
    This means that $p|n$ and $q|n$, so
    \[
    n = pa = qb.
    \]
    Since $\gcd(p,q) = 1$, and $p|qb$, we see by Euclid's lemma,
    Corollary~\ref{C:EL2}, that $p|b$. The smallest $b$ can be with
    this property is $p$. A similar argument shows that $a = q$, hence
    $\o((1,1)) = pq$, and so $\Z_p\times\Z_q$ is cyclic.
  \end{proof}
\end{theorem}


\begin{exercise}
  Use a Cayley table to show that $\Z_2\times\Z_3 \iso \Z_6$.
\end{exercise}



Here's another famous group you might run into. The \textit{Klein
  four-group}.

\begin{definition}
  The Klein four-group is $V_4 = \Z_2\times\Z_2$ with modular addition
  being the operation.
\end{definition}

\begin{exercise}
  Make a Cayley table for $V_4$.
\end{exercise}

\begin{exercise}
  What are the generators of $V_4$?
\end{exercise}

\begin{exercise}
  Is the group $V_4$ isomorphic to the group $\Z_4$?
\end{exercise}



\section{Multiplicative groups}


The cyclic groups $\Z_n$ are groups under addition. However, we also
can multiply elements in $\Z_n$. We now show that modular
multiplication is well defined.

\begin{lemma}[Modular multiplication is well defined]
  Addition on $\Z_n$ is well defined. This means that if
  \begin{align*}
    a &\equiv a' \pmod{n}\\
    b &\equiv b' \pmod{n},
  \end{align*}
  then
  \[
  a\cdot b \equiv a'\cdot b' \pmod{n}.
  \]
  \begin{sketch}
    Use the fact that
    \[
    x \equiv x'\pmod{n} \quad \Leftrightarrow \quad x -x' = n\cdot q
    \]
    for some number $q$.
  \end{sketch}
\end{lemma}

However, $\Z_n$ is \textbf{not a group under multiplication.} The
issue is that $0$ has no inverse. Moreover, any number $x|n$ will also
not have an inverse. We should state this as a lemma.

\begin{lemma}[Multiplicative inverses]
  An element $a\in\Z_n$ has a multiplicative inverse if and only if
  $\gcd(a,n) = 1$.
  \begin{sketch}
    Use Euclid's lemma, Theorem~\ref{T:EL1}.
  \end{sketch}
\end{lemma}

\begin{definition}
  The \dfn{multiplicative group} of $\Z_n$ is the set of elements that
  have multiplicative inverses modulo $n$. It is denoted
  $\Z_n^\times$.
\end{definition}


\begin{exercise}
  Let $p$ be a prime number. Prove that $|\Z_p^\times| = p-1$.
\end{exercise}


\begin{exercise}
  Make a Cayley table for $\Z_n^\times$ for $n = 3,4,5,6,7,8,9$.
\end{exercise}

\begin{exercise}
  Is $\Z_2$ isomorphic to $\Z_3^\times$?
\end{exercise}


\begin{exercise}
  Is $\Z_4$ isomorphic to $\Z_5^\times$?
\end{exercise}

\begin{exercise}
  Is $\Z_6$ isomorphic to $\Z_7^\times$?
\end{exercise}


\begin{definition}
  The \dfn{Euler totient function}, $\eulerphi:\N\to\N$, is defined as
  follows:
  \[
  \eulerphi(n) = |\Z_n^\times|.
  \]
\end{definition}


\begin{exercise}
  Compute $\eulerphi(n)$ for $n = 1,2,\dots, 10$.
\end{exercise}




\begin{exercise}
  Compute $\eulerphi(n)$ for $n = 2,3,6$. Now compute $\eulerphi(n)$
  for $n = 2,5,10$. Finally compute $\eulerphi(n)$ for $n=
  3,5,15$. \textbf{Make wild conjectures.}
\end{exercise}



\subsection{Finding inverses with the Euclidean algorithm}



Now, suppose you have an element in $\Z_n^\times$. How do you find the
multiplicative inverse of this element? We use the Euclidean
algorithm.\index{Euclidean algorithm} Working by example, let's find
the multiplicative inverse of $16$ in $\Z_{21}^\times$. Study
the following calculations:
\begin{align*}
  21 &= 16\cdot 1 + 5 &\Leftrightarrow & &                21-16\cdot 1 &= \boldsymbol{5}\\ 
  16 &= 5\cdot 3 + 1 &\Leftrightarrow  & &   16 - \boldsymbol{5}\cdot 3 &= 1\\ 
  5 &= 1 \cdot 5 + 0 &  & & &
\end{align*}

Now, using back substitution, write:

\begin{align*}
16 - \boldsymbol{5}\cdot 3 &= 1 \\
16 - (21-16\cdot 1)\cdot 3 &= 1 \\
16(4) + 21(-3) &= 1
\end{align*}

This tells me that in $\Z_{21}^\times$,
\[
16\cdot 4 \equiv 1 \pmod{21}.
\]


Now let's do it again. This time we will find the multiplicative
inverse of $49$ in $\Z_{96}^\times$.
%% https://www.calculatorsoup.com/calculators/math/gcf-euclids-algorithm.php
\begin{align*}
  96 &= 49\cdot 1 + 47 &\Leftrightarrow  & &                96 - 49\cdot 1 &= \boldsymbol{47}\\ 
  49 &= 47\cdot 1 + 2  &\Leftrightarrow  & &   49 - \boldsymbol{47}\cdot 1 &= \boldsymbol{2}\\ 
  47 &= 2 \cdot 23 + 1 &\Leftrightarrow  & &   47 - \boldsymbol{2}\cdot 23 &= 1 \\
  2 &= 1\cdot  2+ 0 & & & & 
\end{align*}

Now, using back substitution, write:

\begin{align*}
47 - \boldsymbol{2}\cdot 23 &= 1 \\
\boldsymbol{47} - (49-\boldsymbol{47}\cdot 1)\cdot 23 &= 1 \\
96-49 - (49- (96-49))\cdot 23 &=1 \\
96(24) +49(-47) &=1
\end{align*}

This tells me that in $\Z_{96}^\times$,
\[
49\cdot (-47) \equiv 49\cdot 49 \equiv 1 \pmod{96}.
\]

\begin{exercise} %% 4 steps
  Quick! Find the inverse of $98$ in $\Z_{99}^\times$.
  \begin{hint}
    Note that $98 \equiv -1 \pmod{99}$.
  \end{hint}
\end{exercise}

\begin{exercise}
  Find the inverse of $13$ in $\Z_{56}^\times$.
\end{exercise}

\begin{exercise}
  Find the inverse of $21$ in $\Z_{73}^\times$.
\end{exercise}

\begin{exercise} %% 4 steps
  Find the inverse of $37$ in $\Z_{62}^\times$.
\end{exercise}

\begin{exercise} %% 4 steps
  Find the inverse of $41$ in $\Z_{88}^\times$.
\end{exercise}


\begin{exercise}
  An abstract algebra teacher intended to list the nine integers that
  form a group under multiplication modulo $91$. Instead, one of the
  nine integers was inadvertently left out, so that the list appeared
  as $1$, $9$, $16$, $22$, $53$, $74$, $79$, $81$. Which integer was
  left out? Explain how you reached your conclusion.
\end{exercise}



\section{A nod toward Lagrange}

We will end with statements that will follow from Lagrange's
celebrated theorem. Until then, we will make due with these more
specilized theorems that follow from the division theorem,
Theorem~\ref{T:DT}.

\begin{lemma}[Element's order is at most the group's order]
  Prove that if $G$ is a group and $a\in G$, then $\o(a)\le |G|$.
  \begin{sketch}
    Use the pigeon-hole principle.
  \end{sketch}
\end{lemma}


\begin{theorem}[Element's order divides cyclic group's order]
  Let $G$ be a finite cyclic group with $a\in G$. In this case,
  $\o(a)$ divides $|G|$.
  \begin{sketch}
    Use the division theorem.
  \end{sketch}
\end{theorem}


%% \begin{corollary}[Fermat's little theorem]\index{Fermat's little theorem}
%%   Let $p\in \N$ be a prime number. Given $a\in\Z_p$,
%%   \[
%%   a^{p-1}\equiv 1 \pmod{p}.
%%   \]
%% \end{corollary}


%% \begin{corollary}[Euler's little theorem]\index{Euler's little theorem}
%%   Let $n\in \N$. Given $a\in\Z_n$,
%%   \[
%%   a^{\eulerphi(n)}\equiv 1 \pmod{n}.
%%   \]
%% \end{corollary}





\end{document}
